# Lexical scoping

어휘 범위는 프로그래밍 언어에서 변수의 범위를 결정하는 방법입니다. 어휘 범위 지정을 사용하는 언어에서 변수의 범위는 소스 코드에서 변수 선언 위치에 따라 결정됩니다.

예를 들어 JavaScript에서 각 함수는 새로운 어휘 범위를 만듭니다. 즉, 함수 내에서 선언된 모든 변수는 해당 함수(및 모든 중첩 함수) 내에서만 액세스할 수 있습니다. 함수 외부에서 선언된 변수는 전역 범위에 있으며 코드의 어디에서나 액세스할 수 있습니다.

다음 코드에서

```
javascriptCopy codevar x = 1;

function foo() {
  var y = 2;
  console.log(x); // logs 1
  console.log(y); // logs 2
}

foo();
console.log(x); // logs 1
console.log(y); // throws a ReferenceError
```

이 코드에서 `x`는 함수 `foo` 외부에서 선언되었으므로 전역 범위에 있으며 `foo` 내에서 액세스할 수 있습니다. 반면 `y`는 `foo` 내부에서 선언되며 해당 함수 내에서만 액세스할 수 있습니다.

`foo`를 호출하면 `x`와 `y`가 모두 콘솔에 기록되어 둘 다 함수 내 범위에 있음을 보여줍니다. 그러나 함수 외부에서 `y`를 기록하려고 하면 `y`가 `foo` 외부 범위에 없기 때문에 `ReferenceError`가 발생합니다.

Lexical scoping을 사용하면 독립적이고 코드의 다른 부분을 방해하지 않는 함수를 작성할 수 있습니다. 또한 다른 어휘 범위에서 같은 이름을 가진 변수는 다른 변수로 간주되기 때문에 이름 충돌을 방지하는 데 도움이 됩니다.



### dynamic scoping, block scoping

동적 범위 지정은 호출 스택을 기반으로 런타임에 변수 범위가 결정되는 범위 지정 메커니즘입니다. 동적 범위 지정을 사용하는 언어에서 함수가 호출되면 해당 지역 변수가 호출 스택의 맨 위에 추가되고 함수가 반환되면 해당 지역 변수가 호출 스택의 맨 위에서 제거됩니다. 이는 원래 함수 내에서 호출된 모든 함수가 원래 함수의 지역 변수에 액세스할 수 있음을 의미합니다. 동적 범위 지정은 어휘 범위 지정보다 일반적이지 않으며 코드를 이해하고 유지 관리하기 어렵게 만들 수 있습니다.



블록 범위 지정은 변수의 범위를 변수가 선언된 코드 블록으로 정의하는 범위 지정 메커니즘입니다. 블록 범위 지정은 ECMAScript 6에서 `let` 및 `const` 키워드가 도입된 이후 JavaScript뿐만 아니라 Rust, Go 및 Swift와 같은 최신 프로그래밍 언어에서 자주 사용됩니다. 블록 범위 지정에서 변수는 `let` 또는 `const`는 선언된 코드 블록 내에서만 액세스할 수 있습니다. 이렇게 하면 코드를 더 쉽게 추론할 수 있고 이름 충돌을 방지할 수 있지만 의도하지 않은 버그를 방지하려면 범위 지정 규칙을 신중하게 사용해야 합니다.



### 자바스크립트의 scoping


JavaScript는 변수가 선언되는 방식에 따라 블록 범위 지정과 어휘 범위 지정을 모두 사용합니다.

ECMAScript 6에 `let` 및 `const` 키워드가 도입되기 전에 JavaScript에는 함수 범위만 있었습니다. 즉, 함수 내에서 선언된 변수는 해당 함수 및 모든 중첩 함수 내에서만 액세스할 수 있습니다. 함수 외부에서 선언된 변수는 전역 범위에 있으며 코드의 어디에서나 액세스할 수 있습니다.

`let`과 `const`의 도입으로 JavaScript도 블록 범위를 얻었습니다. `let` 및 `const`로 선언된 변수는 해당 블록이 함수 블록이든 함수 내의 코드 블록이든 관계없이 선언된 코드 블록 내에서만 액세스할 수 있습니다.

예를 들어:

```
javascriptCopy codefunction foo() {
  var x = 1;
  if (true) {
    let y = 2;
    const z = 3;
    console.log(x, y, z); // logs 1, 2, 3
  }
  console.log(x); // logs 1
  console.log(y); // throws a ReferenceError
  console.log(z); // throws a ReferenceError
}
```

이 코드에서 `x`는 `foo` 내부에서 `var`로 선언되므로 함수 범위에 있고 `foo` 내 어디에서나 액세스할 수 있습니다. 반면 `y`와 `z`는 `foo` 내의 코드 블록 내부에서 `let`과 `const`로 선언되므로 해당 블록 내의 범위에만 있습니다.

`y`와 `z`가 선언된 코드 블록 내에 `x`, `y`, `z`를 기록하면 모두 범위 내에 있음을 알 수 있습니다. 그러나 코드 블록 외부에서 `y` 및 `z`를 기록하려고 하면 해당 블록 외부의 범위에 있지 않기 때문에 `ReferenceError`가 발생합니다.

결론적으로 JavaScript는 어휘 범위 지정(`var` 및 함수 선언으로 선언된 변수의 경우)과 블록 범위 지정(`let` 및 `const`로 선언된 변수의 경우)을 모두 사용합니다.